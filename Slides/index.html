<!DOCTYPE html>
<html class="default-theme">
<head>
  <title>iOS App Groups for Debugging</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <textarea id="source">
highlightStyle: dracula
class: inverse middle
# iOS App Groups for Debugging
## Avez-vous déjà livré votre menu debug en Prod ? Nous oui, et nous avons trouvé une solution originale basée sur les App Groups pour que cela n’arrive plus jamais.

---

class: middle
# Agenda

1. Notre Menu Debug
2. Les App Groups, qu’est-ce que c'est ?
3. Démo : Notre nouveau menu Debug
4. Configurer votre projet
5. Utiliser les App Groups programmatiquement
6. Questions

---

# Menu Debug : Chez Meetic

Son but : Modifier le comportement de l’application une fois compilé

--

Comment : Développement d’un `ViewController`.

--

Caché par une gesture : “Shake”, “Three fingers swipe up”

--

Inclus lors de la compilation en scheme DEBUG avec le binaire de notre application

---

# Menu Debug: Son historique chez Meetic

<img src="img/historic.png" width="90%"></img>

---

# App Groups: Qu’est ce que c’est ?

>“App Groups are the scheme iOS uses to allow different apps to share data. If the apps have the right entitlements and proper provisioning, they can access a shared directory outside of their normal iOS sandbox. Sandboxing still applies except for a single exception.”

.footnote[Source: http://www.atomicbird.com/blog/sharing-with-app-extensions]

---

# App Groups: Comment partager des données ?

Partager des données entre applications du même `App Group` en utilisant :
- Keychain
- Préférences: `UserDefaults`
- Fichiers: `FileManager`
- HTTPCookies: `HTTPCookieStorage`

---

# App Groups: Chez Meetic

## Pour nos utilisateurs

Partager le Keychain aux extensions

--

## Pour les développeurs

- Pour nos développeurs back-end, tester que leurs changements ne vont pas casser l’application en production
- Changement d’URL serveur
- Feature Flipping
- Logging
- Langue de l’application sans changer la langue du téléphone via `AppleLanguages`
- Récupérer le push token
- Supprimer le cache
- …

---

class: inverse center middle
# Démo

---

# Que faire d’autre ?

- Récupérer un user id, le numéro de version
- Changer des `UserDefaults` spécifiques
- Ouvrir l’application principale via `DeepLink`

---

class: inverse center middle
# Configurer votre projet

---

class: middle
# Enregister un App Group 1/2

<img src="img/register1.png" width="90%"></img>

---

class: middle
# Enregister un App Group 2/2

<img src="img/register2.png" width="90%"></img>

---

class: middle
# Ajouter aux Entitlements 1/3

<img src="img/entitlements1.png" width="90%"></img>

---

class: middle
# Ajouter aux Entitlements 2/3

<img src="img/entitlements2.png" width="90%"></img>

---

class: middle
# Ajouter aux Entitlements 3/3

<img src="img/capabilities.png" width="90%"></img>

---

class: middle inverse center
# ✅ Prêt à utiliser

---

class: middle
# Utiliser - UserDefaults

```Swift
let userDefaults = UserDefaults(suiteName: "group.com.meetic.ios.cocoaheads")
userDefaults?.bool(forKey: "SharedKey")
```

---

class: middle
# Utiliser - FileManager

```Swift
let fileManager = FileManager.default
let containerURL = fileManager.containerURL(
	forSecurityApplicationGroupIdentifier: "group.com.meetic.ios.cocoaheads"
)
```

---

class: middle
# ⚠️ Important à savoir

Le conteneur partagé n’est pas supprimé si il reste encore une application installée appartenant à l’App Group

Les applications doivent être signées avec le même certificat

---

# Déploiement

- 20 utilisateurs et moins

--

	- Beta Testflight privée ✅

--

- 20 utilisateurs et plus

--

	- Beta Testflight privée ❌

--

	- Autre plateforme de déploiement (HockeyApp) ✅

--

	- Beta Testflight externe ⚠️ 🔥

---

class: inverse middle center
# Questions

---

class: middle
# Projet d’exemple & Slides

https://github.com/Valgrin/AppGroups

<img src="img/qrcode.jpg"></img>

  </textarea>
  <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
  <script>
      var slideshow = remark.create({
        highlightLanguage: 'swift',
        highlightStyle: 'monokai',
      });
  </script>
</body>
</html>